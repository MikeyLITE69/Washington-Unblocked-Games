<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
  <title>S0LACE • Settings</title>

  <link rel="shortcut icon" content="favicon.ico" />
  <link rel="stylesheet" href="index.css" />

  <!-- Core settings engine -->
  <script src="global-hub.js" defer></script>

  <!-- Scramjet SW -->
  <script src="register-sw.js" defer></script>
</head>

<body>
<header class="site-header">
  <div class="site-title">S0LACE</div>
  <nav class="site-nav">
    <a href="index.html">Home</a>
    <a href="games.html">Games</a>
    <a href="media.html">Media</a>
    <a href="settings.html" class="active">Settings</a>
  </nav>
</header>

<main>
  <div class="page-header"><h1>Settings</h1></div>

  <!-- TAB CLOAKING -->
  <section class="home-panel" style="margin-bottom:16px;">
    <div class="motd-label">TAB CLOAKING</div>

    <div style="margin-top:10px;font-size:8px;">
      <div style="margin-bottom:6px;">PRESETS &gt;</div>

      <div style="display:flex;flex-wrap:wrap;gap:6px;">
        <button class="proxy-btn" data-cloak-preset="drive">Google Drive</button>
        <button class="proxy-btn" data-cloak-preset="schoology">Schoology</button>
        <button class="proxy-btn" data-cloak-preset="docs">Google Docs</button>
        <button class="proxy-btn" data-cloak-preset="google">Google</button>
      </div>
    </div>

    <div style="margin-top:14px;border-top:1px solid #262626;padding-top:10px;">
      <div class="motd-label">CUSTOM</div>

      <div style="display:flex;flex-direction:column;gap:6px;font-size:8px;">
        <label>Title<br>
          <input id="cloak-title" type="text"
            placeholder="e.g. My Drive - Google Drive"
            style="width:100%;margin-top:3px;padding:6px 8px;border:2px solid #262626;background:#000;color:#f5f5f5;font-size:8px;font-family:'Press Start 2P';">
        </label>

        <label>Favicon URL<br>
          <input id="cloak-icon" type="text"
            placeholder="https://.../favicon.ico"
            style="width:100%;margin-top:3px;padding:6px 8px;border:2px solid #262626;background:#000;color:#f5f5f5;font-size:8px;font-family:'Press Start 2P';">
        </label>

        <div style="display:flex;gap:8px;margin-top:4px;">
          <button class="proxy-btn" id="apply-custom-cloak">Apply</button>
          <button class="proxy-btn" id="reset-cloak">Reset</button>
        </div>

        <div id="cloak-status" style="font-size:8px;color:#7f7f7f;"></div>
      </div>
    </div>
  </section>

  <!-- ACCENT -->
  <section class="home-panel" style="margin-bottom:16px;">
    <div class="motd-label">ACCENT COLOR</div>

    <div style="margin-top:10px;font-size:8px;">
      <label><input type="radio" name="accent" value="green" class="accent-radio"> green (default)</label>
      <label><input type="radio" name="accent" value="violet" class="accent-radio"> violet</label>
      <label><input type="radio" name="accent" value="amber" class="accent-radio"> amber</label>
      <label><input type="radio" name="accent" value="white" class="accent-radio"> white</label>
    </div>
  </section>

  <!-- THEME -->
  <section class="home-panel" style="margin-bottom:16px;">
    <div class="motd-label">THEME</div>

    <div style="margin-top:10px;font-size:8px;">
      <label><input type="radio" name="theme" value="dark" class="theme-radio"> dark</label>
      <label><input type="radio" name="theme" value="baby" class="theme-radio"> blue</label>
      <label><input type="radio" name="theme" value="xmas" class="theme-radio"> green</label>
    </div>
  </section>

  <!-- BACKGROUND -->
  <section class="home-panel" style="margin-bottom:16px;">
    <div class="motd-label">BACKGROUND</div>

    <div style="margin-top:10px;font-size:8px;">
      <div style="margin-bottom:6px;">MODE &gt;</div>

      <select id="bg-mode"
        style="font-family:'Press Start 2P';font-size:8px;padding:6px 8px;border:2px solid #262626;background:#000;color:#f5f5f5;width:100%;">
        <option value="default">DEFAULT (CRT GRID)</option>
        <option value="gif-stars">STARRY GIF</option>
        <option value="custom">CUSTOM IMAGE URL</option>
      </select>

      <div id="bg-url-row" style="margin-top:8px;display:none;flex-direction:column;gap:4px;">
        <label>Image URL<br>
          <input id="bg-url" type="text" placeholder="https://example.com/bg.gif"
            style="width:100%;margin-top:3px;padding:6px 8px;border:2px solid #262626;background:#000;color:#f5f5f5;font-size:8px;font-family:'Press Start 2P';">
        </label>
      </div>
    </div>
  </section>

  <!-- SECURITY -->
  <section class="home-panel" style="margin-bottom:16px;">
    <div class="motd-label">SECURITY</div>

    <!-- ONLY ANTI-CLOSE — checkbox stays -->
    <label style="font-size:8px;">
      <input type="checkbox" id="anti-close-toggle">
      Blocksi / GoGuardian Disabler (Anti-Close)
    </label>

    <br><br>

    <!-- ABOUT:BLANK BUTTON ONLY -->
    <button class="proxy-btn" id="blank-launch" style="margin-top:8px;">
      Launch in about:blank
    </button>
  </section>

  <!-- STORAGE -->
  <section class="home-panel">
    <div class="motd-label">STORAGE</div>

    <div style="margin-top:8px;font-size:8px;color:#7f7f7f;">
      Settings are stored in <span style="color:var(--accent)">localStorage</span>.
    </div>

    <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;">
      <button class="proxy-btn" id="btn-reset-settings">Reset S0LACE settings</button>
      <button class="proxy-btn" id="btn-clear-media">Clear media cache</button>
    </div>
  </section>
</main>

<script>
/* ================= ANTI-CLOSE BASIC MODE ================= */
window.S0LACE.enableAntiClose = function () {
  localStorage.setItem("s0laceAntiClose", "1");
  window.onbeforeunload = () => "Are you sure you want to leave?";
};

window.S0LACE.disableAntiClose = function () {
  localStorage.removeItem("s0laceAntiClose");
  window.onbeforeunload = null;
};

/* toggle sync */
const anti = document.getElementById("anti-close-toggle");
anti.checked = localStorage.getItem("s0laceAntiClose") === "1";
anti.addEventListener("change", () => {
  if (anti.checked) window.S0LACE.enableAntiClose();
  else window.S0LACE.disableAntiClose();
});

/* ============ ABOUT:BLANK BUTTON ONLY ============ */
document.getElementById("blank-launch").addEventListener("click", () => {
  const win = window.open("about:blank", "_blank");
  if (!win) return alert("Popup blocked — enable popups.");
  win.document.write(`
    <style>
      body { margin:0;background:black;display:flex;align-items:center;justify-content:center; }
      iframe { width:100vw;height:100vh;border:none; }
    </style>
    <iframe src="${location.origin}/index.html"></iframe>
  `);
});

/* rest of your settings code stays unchanged — cloak, accent, theme, bg, reset, cache... */
</script>

</body>
</html>
